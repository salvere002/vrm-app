{"ast":null,"code":"var _jsxFileName = \"/Users/hzh-mac/Downloads/VRM/vrm-app/src/index.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport ReactDOM from 'react-dom';\nimport * as THREE from 'three';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\nimport { VRM, VRMSchema, VRMUtils } from '@pixiv/three-vrm';\nimport { drawConnectors, drawLandmarks } from '@mediapipe/drawing_utils';\nimport { Holistic, POSE_CONNECTIONS, HAND_CONNECTIONS, FACEMESH_TESSELATION } from '@mediapipe/holistic';\nimport { Face, Pose, Hand, Utils, Vector } from 'kalidokit';\nimport * as CameraUtils from '@mediapipe/camera_utils';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst clamp = Utils.clamp;\nconst lerp = Vector.lerp;\nconst App = () => {\n  _s();\n  const rendererRef = useRef();\n  const canvasRef = useRef();\n  const cameraRef = useRef();\n  const controlsRef = useRef();\n  const sceneRef = useRef();\n  const currentVrmRef = useRef();\n  const [isCameraOn, setCameraOn] = useState(true);\n  const toggleCamera = () => {\n    setCameraOn(!isCameraOn);\n  };\n  const videoElement = document.querySelector(\".input_video\");\n  const guideCanvas = document.querySelector('canvas.guides');\n  const renderer = new THREE.WebGLRenderer({\n    alpha: true\n  });\n  renderer.setSize(window.innerWidth, window.innerHeight);\n  renderer.setPixelRatio(window.devicePixelRatio);\n  rendererRef.current = renderer;\n  document.body.appendChild(renderer.domElement);\n  const orbitCamera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.1, 1000);\n  orbitCamera.position.set(0.0, 1.4, 0.7);\n  cameraRef.current = orbitCamera;\n  const orbitControls = new OrbitControls(orbitCamera, renderer.domElement);\n  orbitControls.screenSpacePanning = true;\n  orbitControls.target.set(0.0, 1.4, 0.0);\n  orbitControls.update();\n  controlsRef.current = orbitControls;\n  const scene = new THREE.Scene();\n  sceneRef.current = scene;\n  const light = new THREE.DirectionalLight(0xffffff);\n  light.position.set(1.0, 1.0, 1.0).normalize();\n  scene.add(light);\n  const clock = new THREE.Clock();\n  function animate() {\n    requestAnimationFrame(animate);\n    if (currentVrmRef.current) {\n      currentVrmRef.current.update(clock.getDelta());\n    }\n    renderer.render(scene, orbitCamera);\n  }\n  animate();\n  const loader = new GLTFLoader();\n  loader.crossOrigin = 'anonymous';\n  loader.load('https://rolling-filters.s3.amazonaws.com/3d/vroid.vrm', gltf => {\n    VRMUtils.removeUnnecessaryJoints(gltf.scene);\n    VRM.from(gltf).then(vrm => {\n      scene.add(vrm.scene);\n      currentVrmRef.current = vrm;\n      currentVrmRef.current.scene.rotation.y = Math.PI;\n    });\n  }, progress => {\n    console.log('Loading model...', 100.0 * (progress.loaded / progress.total), '%');\n  }, error => {\n    console.error(error);\n  });\n  const rigRotation = function (name) {\n    let rotation = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n      x: 0,\n      y: 0,\n      z: 0\n    };\n    let dampener = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    let lerpAmount = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0.3;\n    if (!currentVrmRef.current) {\n      return;\n    }\n    const Part = currentVrmRef.current.humanoid.getBoneNode(VRMSchema.HumanoidBoneName[name]);\n    if (!Part) {\n      return;\n    }\n    const euler = new THREE.Euler(rotation.x * dampener, rotation.y * dampener, rotation.z * dampener);\n    const quaternion = new THREE.Quaternion().setFromEuler(euler);\n    Part.quaternion.slerp(quaternion, lerpAmount);\n  };\n  const rigFace = riggedFace => {\n    if (!currentVrmRef.current) {\n      return;\n    }\n    rigRotation('Neck', riggedFace.head, 0.7);\n    const Blendshape = currentVrmRef.current.blendShapeProxy;\n    const PresetName = VRMSchema.BlendShapePresetName;\n    riggedFace.eye.l = lerp(clamp(1 - riggedFace.eye.l, 0, 1), Blendshape.getValue(PresetName.Blink), 0.5);\n    riggedFace.eye.r = lerp(clamp(1 - riggedFace.eye.r, 0, 1), Blendshape.getValue(PresetName.Blink), 0.5);\n    riggedFace.eye = Face.stabilizeBlink(riggedFace.eye, riggedFace.head.y);\n    Blendshape.setValue(PresetName.Blink, riggedFace.eye.l);\n    Blendshape.setValue(PresetName.I, lerp(riggedFace.mouth.shape.I, Blendshape.getValue(PresetName.I), 0.5));\n    Blendshape.setValue(PresetName.A, lerp(riggedFace.mouth.shape.A, Blendshape.getValue(PresetName.A), 0.5));\n    Blendshape.setValue(PresetName.E, lerp(riggedFace.mouth.shape.E, Blendshape.getValue(PresetName.E), 0.5));\n    Blendshape.setValue(PresetName.O, lerp(riggedFace.mouth.shape.O, Blendshape.getValue(PresetName.O), 0.5));\n    Blendshape.setValue(PresetName.U, lerp(riggedFace.mouth.shape.U, Blendshape.getValue(PresetName.U), 0.5));\n    let lookTarget = new THREE.Euler(lerp(oldLookTarget.x, riggedFace.pupil.y, 0.4), lerp(oldLookTarget.y, riggedFace.pupil.x, 0.4), 0, 'XYZ');\n    oldLookTarget.copy(lookTarget);\n    currentVrmRef.current.lookAt.applyer.lookAt(lookTarget);\n  };\n  const animateVRM = (vrm, results) => {\n    if (!vrm) {\n      return;\n    }\n    let riggedFace;\n    const faceLandmarks = results.faceLandmarks;\n    if (faceLandmarks) {\n      riggedFace = Face.solve(faceLandmarks, {\n        runtime: 'mediapipe',\n        video: videoElement\n      });\n      rigFace(riggedFace);\n    }\n  };\n  let oldLookTarget = new THREE.Euler();\n  const onResults = results => {\n    drawResults(results);\n    animateVRM(currentVrmRef.current, results);\n  };\n  const holistic = new Holistic({\n    locateFile: file => {\n      return `https://cdn.jsdelivr.net/npm/@mediapipe/holistic@0.5.1635989137/${file}`;\n    }\n  });\n  holistic.setOptions({\n    modelComplexity: 1,\n    smoothLandmarks: true,\n    minDetectionConfidence: 0.7,\n    minTrackingConfidence: 0.7,\n    refineFaceLandmarks: true\n  });\n  holistic.onResults(onResults);\n  useEffect(() => {\n    const drawResults = results => {\n      guideCanvas.width = videoElement.videoWidth;\n      guideCanvas.height = videoElement.videoHeight;\n      const canvasCtx = guideCanvas.getContext('2d');\n      canvasCtx.save();\n      canvasCtx.clearRect(0, 0, guideCanvas.width, guideCanvas.height);\n      drawConnectors(canvasCtx, results.faceLandmarks, FACEMESH_TESSELATION, {\n        color: '#C0C0C070',\n        lineWidth: 1\n      });\n      if (results.faceLandmarks && results.faceLandmarks.length === 478) {\n        drawLandmarks(canvasCtx, [results.faceLandmarks[468], results.faceLandmarks[468 + 5]], {\n          color: '#ffe603',\n          lineWidth: 2\n        });\n      }\n    };\n    if (isCameraOn) {\n      const videoElement = document.querySelector(\".input_video\");\n      const camera = new CameraUtils.Camera(videoElement, {\n        onFrame: async () => {\n          await holistic.send({\n            image: videoElement\n          });\n        },\n        width: 640,\n        height: 480\n      });\n      camera.start();\n      return () => {\n        camera.stop();\n      };\n    }\n  }, [isCameraOn]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: toggleCamera,\n      style: {\n        position: 'absolute',\n        top: '10px',\n        right: '10px'\n      },\n      children: isCameraOn ? 'Turn camera off' : 'Turn camera on'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n      className: \"input_video\",\n      ref: canvasRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      className: \"guides\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 207,\n    columnNumber: 5\n  }, this);\n};\n_s(App, \"0gmJmrua+HC+riprPeCH0Au9XCE=\");\n_c = App;\nReactDOM.render( /*#__PURE__*/_jsxDEV(App, {}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 216,\n  columnNumber: 17\n}, this), document.getElementById('root'));\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useRef","useState","ReactDOM","THREE","OrbitControls","GLTFLoader","VRM","VRMSchema","VRMUtils","drawConnectors","drawLandmarks","Holistic","POSE_CONNECTIONS","HAND_CONNECTIONS","FACEMESH_TESSELATION","Face","Pose","Hand","Utils","Vector","CameraUtils","jsxDEV","_jsxDEV","clamp","lerp","App","_s","rendererRef","canvasRef","cameraRef","controlsRef","sceneRef","currentVrmRef","isCameraOn","setCameraOn","toggleCamera","videoElement","document","querySelector","guideCanvas","renderer","WebGLRenderer","alpha","setSize","window","innerWidth","innerHeight","setPixelRatio","devicePixelRatio","current","body","appendChild","domElement","orbitCamera","PerspectiveCamera","position","set","orbitControls","screenSpacePanning","target","update","scene","Scene","light","DirectionalLight","normalize","add","clock","Clock","animate","requestAnimationFrame","getDelta","render","loader","crossOrigin","load","gltf","removeUnnecessaryJoints","from","then","vrm","rotation","y","Math","PI","progress","console","log","loaded","total","error","rigRotation","name","arguments","length","undefined","x","z","dampener","lerpAmount","Part","humanoid","getBoneNode","HumanoidBoneName","euler","Euler","quaternion","Quaternion","setFromEuler","slerp","rigFace","riggedFace","head","Blendshape","blendShapeProxy","PresetName","BlendShapePresetName","eye","l","getValue","Blink","r","stabilizeBlink","setValue","I","mouth","shape","A","E","O","U","lookTarget","oldLookTarget","pupil","copy","lookAt","applyer","animateVRM","results","faceLandmarks","solve","runtime","video","onResults","drawResults","holistic","locateFile","file","setOptions","modelComplexity","smoothLandmarks","minDetectionConfidence","minTrackingConfidence","refineFaceLandmarks","width","videoWidth","height","videoHeight","canvasCtx","getContext","save","clearRect","color","lineWidth","camera","Camera","onFrame","send","image","start","stop","children","onClick","style","top","right","fileName","_jsxFileName","lineNumber","columnNumber","className","ref","_c","getElementById","$RefreshReg$"],"sources":["/Users/hzh-mac/Downloads/VRM/vrm-app/src/index.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport ReactDOM from 'react-dom';\nimport * as THREE from 'three';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\nimport { VRM, VRMSchema, VRMUtils } from '@pixiv/three-vrm';\nimport {drawConnectors,drawLandmarks} from '@mediapipe/drawing_utils'\nimport { Holistic, POSE_CONNECTIONS, HAND_CONNECTIONS, FACEMESH_TESSELATION} from '@mediapipe/holistic';\nimport { Face, Pose, Hand, Utils, Vector } from 'kalidokit';\nimport * as CameraUtils from '@mediapipe/camera_utils';\n\nconst clamp = Utils.clamp;\nconst lerp = Vector.lerp;\n\nconst App = () => {\n  const rendererRef = useRef();\n  const canvasRef = useRef();\n  const cameraRef = useRef();\n  const controlsRef = useRef();\n  const sceneRef = useRef();\n  const currentVrmRef = useRef();\n  const [isCameraOn, setCameraOn] = useState(true);\n  const toggleCamera = () => {\n    setCameraOn(!isCameraOn);\n  };\n  \n  const videoElement = document.querySelector(\".input_video\");\n    const guideCanvas = document.querySelector('canvas.guides');\n\n    const renderer = new THREE.WebGLRenderer({ alpha: true });\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    renderer.setPixelRatio(window.devicePixelRatio);\n    rendererRef.current = renderer;\n    document.body.appendChild(renderer.domElement);\n\n    const orbitCamera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.1, 1000);\n    orbitCamera.position.set(0.0, 1.4, 0.7);\n    cameraRef.current = orbitCamera;\n\n    const orbitControls = new OrbitControls(orbitCamera, renderer.domElement);\n    orbitControls.screenSpacePanning = true;\n    orbitControls.target.set(0.0, 1.4, 0.0);\n    orbitControls.update();\n    controlsRef.current = orbitControls;\n\n    const scene = new THREE.Scene();\n    sceneRef.current = scene;\n\n    const light = new THREE.DirectionalLight(0xffffff);\n    light.position.set(1.0, 1.0, 1.0).normalize();\n    scene.add(light);\n\n    const clock = new THREE.Clock();\n\n    function animate() {\n      requestAnimationFrame(animate);\n\n      if (currentVrmRef.current) {\n        currentVrmRef.current.update(clock.getDelta());\n      }\n      renderer.render(scene, orbitCamera);\n    }\n    animate();\n\n    const loader = new GLTFLoader();\n    loader.crossOrigin = 'anonymous';\n    loader.load(\n      'https://rolling-filters.s3.amazonaws.com/3d/vroid.vrm',\n      (gltf) => {\n        VRMUtils.removeUnnecessaryJoints(gltf.scene);\n\n        VRM.from(gltf).then((vrm) => {\n          scene.add(vrm.scene);\n          currentVrmRef.current = vrm;\n          currentVrmRef.current.scene.rotation.y = Math.PI;\n        });\n      },\n      (progress) => {\n        console.log('Loading model...', 100.0 * (progress.loaded / progress.total), '%');\n      },\n      (error) => {\n        console.error(error);\n      }\n    );\n\n    const rigRotation = (name, rotation = { x: 0, y: 0, z: 0 }, dampener = 1, lerpAmount = 0.3) => {\n      if (!currentVrmRef.current) {\n        return;\n      }\n      const Part = currentVrmRef.current.humanoid.getBoneNode(VRMSchema.HumanoidBoneName[name]);\n      if (!Part) {\n        return;\n      }\n\n      const euler = new THREE.Euler(rotation.x * dampener, rotation.y * dampener, rotation.z * dampener);\n      const quaternion = new THREE.Quaternion().setFromEuler(euler);\n      Part.quaternion.slerp(quaternion, lerpAmount);\n    };\n\n    \n\n    const rigFace = (riggedFace) => {\n      if (!currentVrmRef.current) {\n        return;\n      }\n      rigRotation('Neck', riggedFace.head, 0.7);\n\n      const Blendshape = currentVrmRef.current.blendShapeProxy;\n      const PresetName = VRMSchema.BlendShapePresetName;\n\n      riggedFace.eye.l = lerp(clamp(1 - riggedFace.eye.l, 0, 1), Blendshape.getValue(PresetName.Blink), 0.5);\n      riggedFace.eye.r = lerp(clamp(1 - riggedFace.eye.r, 0, 1), Blendshape.getValue(PresetName.Blink), 0.5);\n      riggedFace.eye = Face.stabilizeBlink(riggedFace.eye, riggedFace.head.y);\n      Blendshape.setValue(PresetName.Blink, riggedFace.eye.l);\n\n      Blendshape.setValue(PresetName.I, lerp(riggedFace.mouth.shape.I, Blendshape.getValue(PresetName.I), 0.5));\n      Blendshape.setValue(PresetName.A, lerp(riggedFace.mouth.shape.A, Blendshape.getValue(PresetName.A), 0.5));\n      Blendshape.setValue(PresetName.E, lerp(riggedFace.mouth.shape.E, Blendshape.getValue(PresetName.E), 0.5));\n      Blendshape.setValue(PresetName.O, lerp(riggedFace.mouth.shape.O, Blendshape.getValue(PresetName.O), 0.5));\n      Blendshape.setValue(PresetName.U, lerp(riggedFace.mouth.shape.U, Blendshape.getValue(PresetName.U), 0.5));\n\n      let lookTarget = new THREE.Euler(\n        lerp(oldLookTarget.x, riggedFace.pupil.y, 0.4),\n        lerp(oldLookTarget.y, riggedFace.pupil.x, 0.4),\n        0,\n        'XYZ'\n      );\n      oldLookTarget.copy(lookTarget);\n      currentVrmRef.current.lookAt.applyer.lookAt(lookTarget);\n    };\n\n    const animateVRM = (vrm, results) => {\n      if (!vrm) {\n        return;\n      }\n      let riggedFace;\n\n      const faceLandmarks = results.faceLandmarks;\n\n      if (faceLandmarks) {\n        riggedFace = Face.solve(faceLandmarks, {\n          runtime: 'mediapipe',\n          video: videoElement,\n        });\n        rigFace(riggedFace);\n      }\n    };\n\n    let oldLookTarget = new THREE.Euler();\n    const onResults = (results) => {\n      drawResults(results);\n      animateVRM(currentVrmRef.current, results);\n    };\n\n    \n\n    const holistic = new Holistic({\n      locateFile: (file) => {\n        return `https://cdn.jsdelivr.net/npm/@mediapipe/holistic@0.5.1635989137/${file}`;\n      },\n    },);\n\n    holistic.setOptions({\n      modelComplexity: 1,\n      smoothLandmarks: true,\n      minDetectionConfidence: 0.7,\n      minTrackingConfidence: 0.7,\n      refineFaceLandmarks: true,\n    });\n    holistic.onResults(onResults);\n  useEffect(() => {\n    const drawResults = (results) => {\n      guideCanvas.width = videoElement.videoWidth;\n      guideCanvas.height = videoElement.videoHeight;\n      const canvasCtx = guideCanvas.getContext('2d');\n      canvasCtx.save();\n      canvasCtx.clearRect(0, 0, guideCanvas.width, guideCanvas.height);\n      drawConnectors(canvasCtx, results.faceLandmarks, FACEMESH_TESSELATION, {\n        color: '#C0C0C070',\n        lineWidth: 1,\n      });\n      if (results.faceLandmarks && results.faceLandmarks.length === 478) {\n        drawLandmarks(canvasCtx, [results.faceLandmarks[468], results.faceLandmarks[468 + 5]], {\n          color: '#ffe603',\n          lineWidth: 2,\n        });\n      }\n    };\n    \n    if (isCameraOn) {\n        const videoElement = document.querySelector(\".input_video\");\n        const camera = new CameraUtils.Camera(videoElement, {\n            onFrame: async () => {\n                await holistic.send({ image: videoElement });\n            },\n            width: 640,\n            height: 480\n        });\n        camera.start();\n        return () => {\n            camera.stop();\n        };\n    }\n}, [isCameraOn]);\n\n  return (\n    <div>\n      <button onClick={toggleCamera} style={{ position: 'absolute', top: '10px', right: '10px' }}>\n        {isCameraOn ? 'Turn camera off' : 'Turn camera on'}\n      </button>\n      <video className=\"input_video\" ref={canvasRef} />\n      <canvas className=\"guides\" />\n    </div>\n  );\n};\nReactDOM.render(<App />, document.getElementById('root'));"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}